# 02.服务多活架构分析

保证系统高可用是企业业务稳定的基石，因此大部分企业会采用高可用系统架构支持重要系统，为关键业务提供7x24的不间断服务。服务多活是高可用架构重要实施手段，本文介绍了一些业界常用的多活手段例如同城双活、两地三中心、异地多活架构设计方案并详述了各种方案的优缺点。

---
## **为什么要做多活** 

随着移动互联网的深入发展，用户增长达到一定规模后，不少企业都会面高并发业务和临海量数据的挑战，传统的单机房在机器容量上存在瓶颈。在一些极端场景下，有可能所有服务器都出现故障，例如机房断电、机房火灾、地震等这些不卡抗拒因素会导致系统所有服务器都故障从而导致业务整体瘫痪，而且即使有其他地区的备份，把备份业务系统全部恢复到能够正常提供业务，花费的时间也比较长。为了满足中心业务连续性，增强抗风险能力，多活作为一种可靠的高可用部署架构，成为各大互联网公司的首要选择。

> 多活场景
> 
> 多活架构的关键点就是指不同地理位置上的系统都能够提供业务服务，这里的“活”是指实时提供服务的意思。与“活”对应的是字是“备”，备是备份，正常情况下对外是不提供服务的，如果需要提供服务，则需要大量的人工干预和操作，花费大量的时间才能让“备”变成“活。单纯从描述来看多活很强大，能够保证在灾难的情况下业务都不受影响，是不是意味着不管什么业务，我们都要去实现多活架构呢？其实不是，实现多活架构都要付出一定的代价.
>
> 1. 不同多活方案实现复杂度不一样，随着业务规模和容灾级别的提升，多活方案会给业务系统设计带来更大复杂度。
> 2. 不管采用哪种多活方案都难以完全避免跨机房甚至是跨地区服务调用带来的耗时增加。
> 3. 多活会带来成本会上升，毕竟要多在一个或者多个机房搭建独立的一套业务系统。

因此，多活虽然功能很强大，但也不是每个业务都要上多活。例如，企业内部的 IT 系统、管理系统、博客站点等，如果无法承受异地多活带来的复杂度和成本，是可以不做异地多活的，而对于重要的业务例如核心金融、支付、交易等有必要做多活。

> 多活方案
> 
> 常见的多活方案有同城双活、两地三中心、三地五中心、异地多活等多种技术方案，不同多活方案技术要求、建设成本、运维成本都不一样，下面我们会逐步介绍这几种多活方案并给出每种方案的优点和缺点。选用哪种方案要结合具体业务规模、当前基础建设能力、投入产出比等多种因素来决定。

目前常用的部署架构是：同城双活、异地双活、两地三中心、三地五中心、异地多活。复杂度逐级递升。

详细方案参考：[同城双活与异地多活架构分析](https://mp.weixin.qq.com/s?__biz=MzI4NjY4MTU5Nw==&mid=2247487743&idx=1&sn=3a2c5bc5ca23b82e8a7ec8fd4bf85ba7&chksm=ebd8606ddcafe97bfab4fe4553f88ecb7beba1d343cf3cd7bb353e45bce8459c121f0af01535&scene=178&cur_album_id=1500542612812955651#rd)
